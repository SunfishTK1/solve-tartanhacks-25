<!DOCTYPE html>
<div class="processing-container">
  <h1>Tree Structure</h1>
  <div class="tree-container" *ngIf="!processingComplete">
    <ul class="research-tree">
      <ng-container *ngFor="let node of researchTree">
        <li class="tree-node">
          <span class="node-topic">{{ node.topic }}</span>
          <ul class="subtopics" *ngIf="node.subtopics.length > 0">
            <ng-container *ngFor="let sub of node.subtopics">
              <li class="subtopic-node">
                <span class="subtopic">{{ sub.topic }}</span>
                <ul class="sub-subtopics" *ngIf="sub.subtopics.length > 0">
                  <li *ngFor="let subsub of sub.subtopics">
                    <span class="sub-subtopic">{{ subsub.topic }}</span>
                  </li>
                </ul>
              </li>
            </ng-container>
          </ul>
        </li>
      </ng-container>
    </ul>
  </div>
  <h2 *ngIf="processingComplete" class="completion-text">Analysis complete</h2>
</div>

<app-topbar></app-topbar>

<div class="main-container">
  <div class="summary-section">
    <h2>Research Summary</h2>
    <p>{{ summary }}</p>
  </div>

  <div class="content-container">
    <div class="graph-container">
      <ngx-graph
        [links]="graphData.links"
        [nodes]="graphData.nodes"
        [autoCenter]="true"
        [autoZoom]="true"
        [curve]="curve"
        (nodeClick)="selectedNode = $event.data">
      </ngx-graph>
    </div>

    <div class="sidebar">
      <mat-accordion>
        <mat-expansion-panel *ngFor="let node of researchTree">
          <mat-expansion-panel-header>
            <mat-panel-title>
              {{ node.title }}
            </mat-panel-title>
          </mat-expansion-panel-header>
          <p>{{ node.content }}</p>
          <div *ngIf="node.metrics" class="metrics">
            <p>Authority: {{ node.metrics.authority }}</p>
            <p>Relevance: {{ node.metrics.relevance }}</p>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
  </div>
</div> 