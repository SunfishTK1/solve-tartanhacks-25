<!DOCTYPE html>
<div class="processing-container">
  <h1>Research Progress</h1>
  <div class="tree-container" *ngIf="!processingComplete">
    <ul class="research-tree">
      <li class="tree-node">
        <span class="node-topic">Full Report</span>
        <ul class="subtopics" *ngIf="researchTree[0]?.subquestions?.length">
          <li *ngFor="let subq of researchTree[0]?.subquestions" class="subtopic-node">
            <span class="subtopic">{{ subq.question }}</span>
          </li>
        </ul>
      </li>
    </ul>
  </div>
  <h2 *ngIf="processingComplete" class="completion-text">Analysis complete</h2>
</div>

<div class="main-container">
  <div class="summary-section">
    <h2>Research Progress</h2>
    <p>{{ currentSummary }}</p>
  </div>

  <div class="content-container">
    <div class="graph-container">
      <ngx-graph
        [links]="graphData.links"
        [nodes]="graphData.nodes"
        [autoCenter]="true"
        [autoZoom]="true"
        [curve]="curve">
      </ngx-graph>
    </div>

    <div class="sidebar">
      <mat-accordion>
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>Full Report</mat-panel-title>
          </mat-expansion-panel-header>
          <p>{{ researchTree[0]?.full_report }}</p>
        </mat-expansion-panel>

        <mat-expansion-panel *ngFor="let subq of researchTree[0]?.subquestions">
          <mat-expansion-panel-header>
            <mat-panel-title>{{ subq?.question }}</mat-panel-title>
          </mat-expansion-panel-header>
          <p>{{ subq?.result }}</p>
          <div class="metrics">
            <p>Depth: {{ subq?.depth }}</p>
          </div>
          <div *ngIf="subq?.other_questions?.length">
            <h4>Related Questions:</h4>
            <ul>
              <li *ngFor="let otherQ of subq.other_questions">{{ otherQ }}</li>
            </ul>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
  </div>
</div> 